(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{131:function(t,a,e){},144:function(t,a,e){"use strict";e(131)},154:function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("form",{staticClass:"works-form",class:{activeform:t.isActiveForm}},[t._m(0),e("div",{staticClass:"works-add reviews__add"},[e("div",{staticClass:"reviews__imgwrap"},[e("div",{staticClass:"reviews__image"},[e("img",{directives:[{name:"show",rawName:"v-show",value:!t.filePreview,expression:"!filePreview"}],staticClass:"reviews__stub",attrs:{src:t.userPic}}),e("img",{directives:[{name:"show",rawName:"v-show",value:t.filePreview,expression:"filePreview"}],staticClass:"reviews__stub",attrs:{src:t.filePreview}})]),e("a",{staticClass:"works-add__undo reviews-avatar"},[t._v("Добавить фото"),e("input",{attrs:{type:"file",accept:"image/jpeg"},on:{change:function(a){return t.processFile(a)}}})])]),e("div",{staticClass:"reviews__desc"},[e("div",{staticClass:"reviews__row"},[e("label",{staticClass:"works-add__row reviews-add__row"},[e("div",{staticClass:"works-add__title"},[t._v("Имя автора")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.author,expression:"formdata.author"}],staticClass:"works-add__text",attrs:{type:"text",placeholder:"Имя Фамилия"},domProps:{value:t.formdata.author},on:{input:function(a){a.target.composing||t.$set(t.formdata,"author",a.target.value)}}}),e("span",{staticClass:"error"},[t._v(t._s(this.validation.firstError("formdata.author")))])]),e("label",{staticClass:"works-add__row reviews-add__row"},[e("div",{staticClass:"works-add__title"},[t._v("Титул автора")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.formdata.occ,expression:"formdata.occ"}],staticClass:"works-add__text",attrs:{type:"text",placeholder:"Основатель LoftSchool"},domProps:{value:t.formdata.occ},on:{input:function(a){a.target.composing||t.$set(t.formdata,"occ",a.target.value)}}}),e("span",{staticClass:"error"},[t._v(t._s(this.validation.firstError("formdata.occ")))])])]),e("label",{staticClass:"works-add__row"},[e("div",{staticClass:"works-add__title"},[t._v("Отзыв")]),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formdata.text,expression:"formdata.text"}],staticClass:"reviews-add__textarea",attrs:{cols:"30",rows:"10",placeholder:"Этот парень проходил обучение..."},domProps:{value:t.formdata.text},on:{input:function(a){a.target.composing||t.$set(t.formdata,"text",a.target.value)}}}),e("span",{staticClass:"error"},[t._v(t._s(this.validation.firstError("formdata.text")))])]),e("div",{staticClass:"works-add__save"},[e("button",{staticClass:"works-add__undo",attrs:{type:"button"},on:{click:function(a){return a.preventDefault(),t.clearForm.apply(null,arguments)}}},[t._v("Отмена")]),e("button",{staticClass:"works-add__savebtn",attrs:{type:"button"},on:{click:t.submitForm}},[t._v("Сохранить")])])])])])};r._withStripped=!0;var o=e(7),i=e(6),s={components:{appInput:e(22).a},data:function(){return{formdata:{author:"",occ:"",photo:0,text:""},filePreview:"",isActiveForm:!1}},props:{isEdit:Boolean,forEdit:Object,isReady:Boolean},watch:{forEdit:{immediate:!1,handler:function(t,a){this.editFill()}},isReady:{immediate:!0,handler:function(t,a){this.isActiveForm=t}}},computed:{titleError:function(){return this.validation.firstError("formdata.title")},percentError:function(){return this.validation.firstError("formdata.link")},userPic:function(){return e(71).default}},validators:{"formdata.author":function(t){return o.Validator.value(t).required()},"formdata.occ":function(t){return o.Validator.value(t).required()},"formdata.text":function(t){return o.Validator.value(t).required()}},methods:{processFile:function(t){var a=this;this.formdata.photo=t.target.files[0],this.renderFile(this.formdata.photo).then((function(t){a.filePreview=t}))},selectImage:function(t){this.file=t;var a=new FileReader;a.onload=this.formdata.photo,a.readAsDataURL(t),console.log(t)},renderFile:function(t){var a=new FileReader;return new Promise((function(e,r){try{a.readAsDataURL(t),a.onloadend=function(){e(a.result)}}catch(t){throw new Error("Ошибка при чтении файла")}}))},submitForm:function(){var t=this;if(!0===this.isEdit){var a=new FormData;a.append("photo",this.formdata.photo),a.append("title",this.formdata.author),a.append("occ",this.formdata.occ),a.append("text",this.formdata.text),i.a.post("/reviews/".concat(this.forEdit.id),a).then((function(a){t.formdata.author="",t.formdata.occ="",t.formdata.photo=0,t.formdata.text=""}))}else{var e=new FormData;e.append("photo",this.formdata.photo),e.append("author",this.formdata.author),e.append("occ",this.formdata.occ),e.append("text",this.formdata.text),this.$validate().then((function(a){a?i.a.post("/reviews",e).then((function(a){t.formdata.author="",t.formdata.occ="",t.formdata.photo=0,t.formdata.text=""})):console.log("Validation error reviews")}))}},editFill:function(){this.formdata.author=this.forEdit.author,this.formdata.occ=this.forEdit.occ,this.formdata.photo=this.forEdit.photo,this.formdata.text=this.forEdit.text},clearForm:function(){this.formdata.author="",this.formdata.occ="",this.formdata.photo=0,this.formdata.text="",this.isActiveForm=!1,this.$emit("cancel-sites")}}},d=(e(144),e(1)),n=Object(d.a)(s,r,[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"titlerow"},[a("div",{staticClass:"title-admin"},[this._v("Новый отзыв")])])}],!1,null,"42ee022b",null);n.options.__file="src/admin/components/reviews/reviewsForm.vue";a.default=n.exports},71:function(t,a,e){"use strict";e.r(a),a.default=e.p+"4c828049ec6a48664af1626f74a2c4a3.jpg"}}]);